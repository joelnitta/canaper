<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Categorical Analysis of Neo- and Paleo-endemism in R • canaper</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Categorical Analysis of Neo- and Paleo-endemism in R">
<meta property="og:description" content="Provides functions to conduct categorical analysis of neo- and paleo-endemism (CANAPE) in R..">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">canaper</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/canape.html">CANAPE example</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/joelnitta/canaper/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="canaper" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#canaper" class="anchor"></a>canaper</h1></div>
<!-- badges: start -->

<p>The goal of canaper is to enable categorical analysis of neo- and paleo-endemism (CANAPE) in R.</p>
<div id="important-note" class="section level2">
<h2 class="hasAnchor">
<a href="#important-note" class="anchor"></a>Important note</h2>
<p><strong>This package is in early development.</strong> There may be major, breaking changes to functionality in the near future. If you use this package, I highly recommend using a package manager like <a href="https://rstudio.github.io/renv/articles/renv.html">renv</a> so that later updates won’t break your code.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install canaper from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"joelnitta/canaper"</span><span class="op">)</span></code></pre></div>
</div>
<div id="example-usage" class="section level2">
<h2 class="hasAnchor">
<a href="#example-usage" class="anchor"></a>Example usage</h2>
<p>These examples will use the dataset included with the <code>picante</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joelnitta/canaper">canaper</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">picante</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: ape</span>
<span class="co">#&gt; Loading required package: vegan</span>
<span class="co">#&gt; Loading required package: permute</span>
<span class="co">#&gt; Loading required package: lattice</span>
<span class="co">#&gt; This is vegan 2.5-7</span>
<span class="co">#&gt; Loading required package: nlme</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">phylocom</span><span class="op">)</span>

<span class="co"># Example community matrix including 4 "clumped" communities, </span>
<span class="co"># one "even" community, and one "random" community</span>
<span class="va">phylocom</span><span class="op">$</span><span class="va">sample</span>
<span class="co">#&gt;         sp1 sp10 sp11 sp12 sp13 sp14 sp15 sp17 sp18 sp19 sp2 sp20 sp21 sp22</span>
<span class="co">#&gt; clump1    1    0    0    0    0    0    0    0    0    0   1    0    0    0</span>
<span class="co">#&gt; clump2a   1    2    2    2    0    0    0    0    0    0   1    0    0    0</span>
<span class="co">#&gt; clump2b   1    0    0    0    0    0    0    2    2    2   1    2    0    0</span>
<span class="co">#&gt; clump4    1    1    0    0    0    0    0    2    2    0   1    0    0    0</span>
<span class="co">#&gt; even      1    0    0    0    1    0    0    1    0    0   0    0    1    0</span>
<span class="co">#&gt; random    0    0    0    1    0    4    2    3    0    0   1    0    0    1</span>
<span class="co">#&gt;         sp24 sp25 sp26 sp29 sp3 sp4 sp5 sp6 sp7 sp8 sp9</span>
<span class="co">#&gt; clump1     0    0    0    0   1   1   1   1   1   1   0</span>
<span class="co">#&gt; clump2a    0    0    0    0   1   1   0   0   0   0   2</span>
<span class="co">#&gt; clump2b    0    0    0    0   1   1   0   0   0   0   0</span>
<span class="co">#&gt; clump4     0    2    2    0   0   0   0   0   0   0   1</span>
<span class="co">#&gt; even       0    1    0    1   0   0   1   0   0   0   1</span>
<span class="co">#&gt; random     2    0    0    0   0   0   2   0   0   0   0</span>

<span class="co"># Example phylogeny</span>
<span class="va">phylocom</span><span class="op">$</span><span class="va">phy</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Phylogenetic tree with 32 tips and 31 internal nodes.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Tip labels:</span>
<span class="co">#&gt;   sp1, sp2, sp3, sp4, sp5, sp6, ...</span>
<span class="co">#&gt; Node labels:</span>
<span class="co">#&gt;   A, B, C, D, E, F, ...</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rooted; includes branch lengths.</span></code></pre></div>
<p>The main “workhorse” function of <code>canaper</code> is <code><a href="reference/cpr_rand_test.html">cpr_rand_test()</a></code>, which conducts a randomization test to determine if observed values of phylogenetic diversity (PD) and phylogenetic endemism (PE) are significantly different from random. It also calculates the same values on an alternative phylogeny where all branch lengths have been set equal (alternative PD, alternative PE) as well as the ratio of the original value to the alternative value (relative PD, relative PE).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">071421</span><span class="op">)</span>
<span class="va">rand_test_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cpr_rand_test.html">cpr_rand_test</a></span><span class="op">(</span><span class="va">phylocom</span><span class="op">$</span><span class="va">sample</span>, <span class="va">phylocom</span><span class="op">$</span><span class="va">phy</span><span class="op">)</span>
<span class="co">#&gt; [1] "Dropping tips from the tree because they are not present in the community data:"</span>
<span class="co">#&gt; [1] "sp16" "sp23" "sp27" "sp28" "sp30" "sp31" "sp32"</span></code></pre></div>
<p><code>cpr_rand_test</code> produces <strong>a lot</strong> of columns (nine per metric), so let’s just look at a subset of them:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rand_test_results</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span>
<span class="co">#&gt;            pd_obs pd_rand_mean pd_rand_sd  pd_obs_z pd_obs_c_upper</span>
<span class="co">#&gt; clump1  0.3018868    0.4679245 0.02850761 -5.824331              0</span>
<span class="co">#&gt; clump2a 0.3207547    0.4703774 0.03130385 -4.779688              0</span>
<span class="co">#&gt; clump2b 0.3396226    0.4624528 0.03133141 -3.920353              0</span>
<span class="co">#&gt; clump4  0.4150943    0.4688679 0.03551447 -1.514132              4</span>
<span class="co">#&gt; even    0.5660377    0.4692453 0.03836478  2.522951            100</span>
<span class="co">#&gt; random  0.5094340    0.4698113 0.03086949  1.283553             85</span>
<span class="co">#&gt;         pd_obs_c_lower pd_obs_q pd_obs_p_upper pd_obs_p_lower</span>
<span class="co">#&gt; clump1             100      100           0.00           1.00</span>
<span class="co">#&gt; clump2a            100      100           0.00           1.00</span>
<span class="co">#&gt; clump2b            100      100           0.00           1.00</span>
<span class="co">#&gt; clump4              88      100           0.04           0.88</span>
<span class="co">#&gt; even                 0      100           1.00           0.00</span>
<span class="co">#&gt; random               7      100           0.85           0.07</span></code></pre></div>
<p>This is a summary of the columns:</p>
<ul>
<li>
<code>*_obs</code>: Observed value</li>
<li>
<code>*_obs_c_lower</code>: Count of times observed value was lower than random values</li>
<li>
<code>*_obs_c_upper</code>: Count of times observed value was higher than random values</li>
<li>
<code>*_obs_p_lower</code>: Percentage of times observed value was lower than random values</li>
<li>
<code>*_obs_p_upper</code>: Percentage of times observed value was higher than random values</li>
<li>
<code>*_obs_q</code>: Count of the non-NA random values used for comparison</li>
<li>
<code>*_obs_z</code>: Standard effect size (z-score)</li>
<li>
<code>*_rand_mean</code>: Mean of the random values</li>
<li>
<code>*_rand_sd</code>: Standard deviation of the random values</li>
</ul>
<p>The next step in CANAPE is to classify endemism types according to the significance of PE, alternative PE, and relative PE. This adds a column called <code>endem_type</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">canape_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/cpr_classify_endem.html">cpr_classify_endem</a></span><span class="op">(</span><span class="va">rand_test_results</span><span class="op">)</span>

<span class="va">canape_results</span><span class="op">[</span>, <span class="st">"endem_type"</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span>
<span class="co">#&gt;              endem_type</span>
<span class="co">#&gt; clump1  not significant</span>
<span class="co">#&gt; clump2a not significant</span>
<span class="co">#&gt; clump2b not significant</span>
<span class="co">#&gt; clump4  not significant</span>
<span class="co">#&gt; even              super</span>
<span class="co">#&gt; random            super</span></code></pre></div>
<p>This data set is very small, so it doesn’t include all possible endemism types. In total, they include:</p>
<ul>
<li>
<code>paleo</code>: paleoendemic</li>
<li>
<code>neo</code>: neoendemic</li>
<li>
<code>not significant</code> (what it says)</li>
<li>
<code>mixed</code>: mixture of both paleo and neo</li>
<li>
<code>super</code>: mixed and highly significant (<em>p</em> &lt; 0.01)</li>
</ul>
<p>For a more complete example, please <a href="https://joelnitta.github.io/canaper/articles/canape.html">see the vignette</a></p>
</div>
<div id="other-information" class="section level2">
<h2 class="hasAnchor">
<a href="#other-information" class="anchor"></a>Other information</h2>
<p>Poster at Botany 2021</p>
<ul>
<li><a href="https://github.com/joelnitta/botany_poster_2021/raw/main/canaper.pdf">PDF</a></li>
<li><a href="https://www.youtube.com/watch?v=LXn_ziEli_Q">Video</a></li>
</ul>
</div>
<div id="citing-this-package" class="section level2">
<h2 class="hasAnchor">
<a href="#citing-this-package" class="anchor"></a>Citing this package</h2>
<p>If you use this package, please cite it! Here is an example:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>Nitta JH, Iwasaki <span class="kw">W.</span> (<span class="dv">2021</span>) canaper<span class="op">:</span><span class="st"> </span>Categorical analysis of neo<span class="op">-</span><span class="st"> </span>and paleo<span class="op">-</span>endemism <span class="cf">in</span> R. doi<span class="op">:</span><span class="st"> </span><span class="fl">10.5281</span><span class="op">/</span>zenodo<span class="fl">.5094032</span></span></code></pre></div>
<p>The example DOI above is for the overall package.</p>
<p>Here is the latest DOI, which you should use if you are using the latest version of the package:</p>
<p><a href="https://zenodo.org/badge/latestdoi/359280907"><img src="https://zenodo.org/badge/359280907.svg" alt="DOI"></a></p>
<p>You can find DOIs for older versions by viewing the “Releases” menu on the right.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Mishler, B., Knerr, N., González-Orozco, C. <em>et al</em>. Phylogenetic measures of biodiversity and neo- and paleo-endemism in Australian <em>Acacia</em>. <em>Nat Commun</em> 5, 4473 (2014). <a href="https://doi.org/10.1038/ncomms5473" class="uri">https://doi.org/10.1038/ncomms5473</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/joelnitta/canaper/">https://​github.com/​joelnitta/​canaper/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/joelnitta/canaper/issues">https://​github.com/​joelnitta/​canaper/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing canaper</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Joel Nitta <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-4719-7472" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://zenodo.org/badge/latestdoi/359280907"><img src="https://zenodo.org/badge/359280907.svg" alt="DOI"></a></li>
<li><a href="https://github.com/joelnitta/canaper/actions"><img src="https://github.com/joelnitta/canaper/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://www.repostatus.org/#wip"><img src="https://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP – Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Joel Nitta.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
